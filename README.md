# 学员报名管理系统

## 项目概述
这是一个完整的学员报名管理系统，包含微信小程序前端、Node.js后台API服务和Web后台管理界面。系统集成了完整的报名流程管理、用户数据统计、黑名单管理等功能，为教育培训机构提供一站式报名解决方案。

## 系统架构

### 1. 微信小程序（前端）
用户报名流程的移动端界面，包含完整的7步报名流程：

#### 功能特性
- ✅ 岗位保护查询系统
- ✅ 黑名单校验功能  
- ✅ 报名须知阅读确认
- ✅ 完整的报名信息表单
- ✅ 缴费截图上传功能
- 🔄 飞书多维表格数据同步（待接入API）

### 2. 后台API服务（Node.js）
提供数据管理和业务逻辑支持的RESTful API服务：

#### 技术栈
- **框架**: Express.js
- **数据库**: MySQL 2 (支持，当前使用模拟数据)
- **跨域处理**: CORS
- **环境变量**: dotenv

#### API功能模块
- 📊 **用户管理API**: 用户统计、列表查询、数据导出
- 📋 **黑名单管理API**: 黑名单查询、统计、状态管理
- 🔍 **数据统计API**: 访问统计、有效用户、近期活跃度

### 3. Web后台管理系统（管理界面）
功能完善的Web管理界面，支持多模块数据管理：

#### 核心管理模块
- 🏠 **仪表盘**: 数据概览、统计图表、快捷操作入口
- 👥 **用户管理**: 用户列表、信息编辑、数据导入导出
- 🚫 **黑名单管理**: 黑名单维护、状态控制、批量操作
- 📋 **项目管理**: 培训项目创建、编辑、发布状态管理
- 🎓 **班型管理**: 课程班级配置、人数限制、价格设置
- 💰 **优惠管理**: 优惠券、折扣活动、促销规则
- 📝 **报名管理**: 报名记录查看、审核、状态跟踪
- 💼 **招考岗位管理**: 岗位信息维护、保护状态设置

#### 界面特色
- 响应式设计，支持桌面和移动端访问
- 实时数据更新，支持数据筛选和搜索
- 完整的CRUD操作，支持批量处理
- 数据导入导出，支持Excel格式

## 项目结构
```
mini programme/
├── mini programme/           # 微信小程序
│   ├── app.js               # 小程序主文件
│   ├── app.json             # 小程序配置
│   ├── app.wxss             # 全局样式
│   ├── sitemap.json         # 站点地图配置
│   └── pages/               # 页面目录
│       ├── index/           # 首页
│       ├── position-check/  # 岗位保护查询页
│       ├── blacklist-verify/ # 黑名单校验页
│       ├── notice/          # 报名须知页
│       ├── registration/    # 报名信息填写页
│       ├── payment-upload/  # 缴费截图上传页
│       ├── success/         # 提交成功页
│       ├── phone-auth/      # 手机认证页
│       ├── registration-status/ # 报名状态查询页
│       ├── registration-queue/  # 报名队列页
│       ├── registration-failed/ # 报名失败页
│       └── approval-result/ # 审核结果页
├── backend/                 # 后台API服务
│   ├── src/
│   │   ├── config/          # 配置文件
│   │   │   ├── database.js  # 数据库配置和模拟数据
│   │   │   └── blacklist.js # 黑名单配置
│   │   └── routes/          # API路由
│   │       ├── users.js     # 用户相关API
│   │       └── blacklist.js # 黑名单相关API
│   ├── app.js               # 应用程序入口
│   ├── package.json         # 项目依赖配置
│   └── README.md            # 后台服务说明文档
├── admin/                   # Web后台管理界面
│   ├── css/                 # 样式文件
│   │   └── admin.css        # 管理界面样式
│   ├── index.html           # 仪表盘
│   ├── login.html           # 登录页面
│   ├── users.html           # 用户管理
│   ├── blacklist.html       # 黑名单管理
│   ├── projects.html        # 项目管理
│   ├── classes.html         # 班型管理
│   ├── discounts.html       # 优惠管理
│   ├── registrations.html   # 报名管理
│   ├── registrations-projects.html  # 项目报名管理
│   ├── registrations-detail.html    # 报名详情
│   ├── positions-projects.html      # 招考岗位管理
│   └── positions-detail.html        # 岗位详情
├── start.sh                 # 启动脚本
└── README.md                # 项目说明文档
```

## 快速开始

### 环境要求
- Node.js 16+ 
- 微信开发者工具
- MySQL 数据库（可选，支持模拟数据）

### 安装和运行

#### 1. 后台API服务
```bash
cd backend
npm install
npm run dev  # 开发模式
npm start    # 生产模式
```

#### 2. 微信小程序
1. 在微信开发者工具中导入项目
2. 配置小程序AppID
3. 设置服务器域名和API接口

#### 3. 后台管理界面
服务启动后访问：http://localhost:3000/admin

### 访问地址
- **后台管理**: http://localhost:3000/admin
- **API服务**: http://localhost:3000/api  
- **健康检查**: http://localhost:3000/health

## 系统功能详解

### 微信小程序用户流程
1. **首页** → 展示报名流程，引导用户开始报名
2. **岗位保护查询** → 输入身份信息查询是否有岗位保护
3. **黑名单校验** → 自动校验用户是否在黑名单中
4. **报名须知** → 用户必须阅读完毕并同意才能继续
5. **报名信息填写** → 填写详细的报名信息
6. **缴费截图上传** → 上传付款凭证
7. **提交成功** → 显示报名编号和后续流程

### 后台管理功能模块

#### 数据看板
- 实时统计用户访问量、有效报名数、黑名单数量
- 可视化图表展示数据趋势
- 快捷操作入口，支持数据筛选

#### 用户管理
- 用户信息查看、编辑、删除
- 访问记录统计和分析
- 批量数据导入导出（支持CSV/Excel）
- 用户授权状态管理

#### 黑名单管理
- 黑名单用户添加、编辑、删除
- 状态控制（启用/禁用）
- 批量操作和搜索筛选
- 黑名单原因记录

#### 项目管理
- 培训项目创建、编辑、删除
- 项目状态管理（草稿/已发布/已过期）
- 报名人数统计和限制设置
- 项目复制和批量操作

#### 班型和优惠管理
- 课程班级配置和价格设置
- 优惠券和折扣活动管理
- 促销规则配置

#### 报名管理
- 报名记录查看和审核
- 状态跟踪（待审核/通过/拒绝）
- 报名数据统计和分析
- 缴费凭证查看

#### 招考岗位管理
- 岗位信息维护和编辑
- 岗位保护状态设置
- 岗位与项目关联管理

## API接口文档

### 用户管理API
- `GET /api/users/stats` - 获取用户统计数据
- `GET /api/users` - 获取用户列表（支持分页和搜索）
- `GET /api/users/total-visitors` - 获取访问总人数
- `GET /api/users/valid-users` - 获取有效用户数
- `GET /api/users/recent-visitors` - 获取近一个月访问人数

### 黑名单管理API
- `GET /api/blacklist/stats` - 获取黑名单统计数据
- `GET /api/blacklist` - 获取黑名单列表（支持分页、搜索和状态筛选）
- `GET /api/blacklist/total` - 获取黑名单总数
- `GET /api/blacklist/active` - 获取生效黑名单数

## 数据管理

### 小程序本地存储
使用 `wx.setStorageSync()` 存储流程中的临时数据：
### 后台数据存储
当前使用模拟数据进行演示，支持以下数据管理：
- **用户数据**: 包含150个模拟用户记录，支持OpenID、微信昵称、手机号等字段
- **黑名单数据**: 支持状态管理、搜索筛选、批量操作
- **项目数据**: 支持培训项目的完整生命周期管理
- **报名数据**: 支持报名记录的状态跟踪和统计分析

### 飞书多维表格集成（计划中）
- 基础信息：报名编号、时间、姓名、身份证、联系方式
- 状态信息：岗位保护状态、黑名单状态、审核状态
- 报名详情：选择岗位、学历、经验、缴费截图等

## 开发部署

### 本地开发
1. 克隆项目到本地
2. 安装后台服务依赖：`cd backend && npm install`
3. 启动开发服务：`npm run dev`
4. 在微信开发者工具中导入小程序项目
5. 访问管理后台：http://localhost:3000/admin

### 生产部署
1. **数据库配置**: 配置实际的MySQL数据库连接
2. **环境变量**: 设置生产环境配置文件`.env`
3. **进程管理**: 使用PM2等工具管理Node.js进程
4. **反向代理**: 配置Nginx实现负载均衡和HTTPS
5. **小程序发布**: 通过微信开发者工具提交审核和发布

### 安全考虑
- 用户敏感数据仅存储在本地缓存，不上传服务器
- API接口支持CORS跨域配置
- 生产环境需配置HTTPS和安全头
- 定期备份重要的报名数据

## 技术实现要点

### 微信小程序开发
- **框架**: 原生微信小程序框架
- **页面导航**: 使用 `wx.navigateTo()` 进行页面跳转
- **数据持久化**: `wx.setStorageSync()`/`wx.getStorageSync()` 
- **图片处理**: `wx.chooseMedia()` 支持相机拍照和相册选择
- **表单验证**: 身份证号、手机号、邮箱格式验证
- **用户体验**: 实时输入验证和友好的错误提示

### 后台API开发
- **框架**: Express.js + Node.js
- **数据层**: 当前使用模拟数据，支持MySQL集成
- **API设计**: RESTful风格，统一的响应格式
- **错误处理**: 完善的异常捕获和错误返回
- **跨域支持**: CORS中间件配置

### 前端管理界面
- **技术栈**: 原生HTML/CSS/JavaScript
- **样式框架**: 自定义CSS框架，响应式设计
- **图标库**: Font Awesome 6.0
- **交互体验**: 实时数据更新、动态加载、通知提示

## 扩展功能规划

### 短期规划
1. **API集成**: 接入真实的岗位保护查询API和黑名单校验API
2. **数据库集成**: 替换模拟数据，使用MySQL数据库
3. **飞书集成**: 完成飞书多维表格API对接
4. **消息推送**: 实现报名状态变更的消息通知

### 长期规划  
1. **移动端管理**: 开发管理员移动端应用
2. **数据分析**: 增加报名数据分析和可视化图表
3. **多租户支持**: 支持多机构、多项目的SaaS模式
4. **智能推荐**: 基于用户画像的课程推荐系统

## 许可证与支持

### 开源许可
MIT License - 详见项目根目录LICENSE文件

### 技术支持
- 项目文档：详见各模块README文档
- 问题反馈：GitHub Issues
- 技术交流：开发者社区

---
*本项目为教育培训机构量身定制的完整报名管理解决方案，注重用户体验、数据安全和系统稳定性。*